scrPlans As screen:
    LoadingSpinnerColor: =RGBA(100, 118, 132, 1)
    OnVisible: |-
        =If(
            !IsBlank(Param("plan")),
            Select(btnHiddenToProcessPreselectedPlan),
            Select(iconRefresh)
        );
        Reset('Latest Version Info_1')

    galListPlans As gallery.galleryHorizontal:
        BorderColor: =RGBA(32, 54, 71, 1)
        BorderStyle: =BorderStyle.None
        Height: =567
        Items: =SortByColumns(collAllUserPlans, "title", Ascending)
        TemplatePadding: =0
        TemplateSize: =300
        Transition: =Transition.Push
        Width: =1207
        WrapCount: =2
        X: =87
        Y: =75
        ZIndex: =1

        lblPlanName As label:
            Align: =Align.Center
            BorderColor: =Theme.Color.Light
            BorderThickness: =3
            Color: =RGBA(255, 255, 255, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            Fill: =Theme.Color.Dark
            FontWeight: =FontWeight.Semibold
            Height: =180
            OnSelect: |-
                =ClearCollect(selectedSinglePlanColl, ThisItem);
                Navigate(scrGantt, ScreenTransition.Fade, { idsOfSelectedPlans: ShowColumns(selectedSinglePlanColl, "id", "title") })
            PaddingLeft: =100
            PaddingRight: =100
            Size: =24
            Text: =ThisItem.title
            Visible: =false
            Width: =400
            ZIndex: =1

        btnPlan As button:
            BorderColor: =Theme.Color.LighterDark
            Color: =Theme.Color.LighterDark
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: =Theme.Color.Light
            FontWeight: =FontWeight.Semibold
            Height: =250
            HoverColor: =RGBA(255, 255, 255, 1)
            OnSelect: |-
                =ClearCollect(selectedSinglePlanColl, ThisItem);
                Navigate(scrGantt, ScreenTransition.Fade, { idsOfSelectedPlans: ShowColumns(selectedSinglePlanColl, "id", "title"), myTasks: false })
            Size: =22
            Text: =ThisItem.title
            Width: =260
            X: =18
            Y: =2
            ZIndex: =2

        cbSelectPlan As checkbox:
            BorderColor: =RGBA(32, 54, 71, 1)
            BorderStyle: =BorderStyle.None
            CheckboxBackgroundFill: =Theme.Color.Light
            CheckboxBorderColor: =Theme.Color.LighterDark
            CheckboxSize: =70
            CheckmarkFill: =Theme.Color.Dark
            Color: =RGBA(99, 139, 44, 1)
            Height: =70
            HoverColor: =RGBA(32, 54, 71, 1)
            OnSelect: =Select(Parent)
            Size: =13
            Text: =""
            Width: =67
            X: =btnPlan.Width - Self.Width
            Y: =btnPlan.Height - Self.Height - 5
            ZIndex: =3

        iconOpenPlan_1 As icon.OpenInNewWindow:
            BorderColor: =RGBA(32, 54, 71, 1)
            Color: =Theme.Color.LighterDark
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(244, 244, 244, 1)
            Height: =56
            Icon: =Icon.OpenInNewWindow
            OnSelect: |-
                =Launch("https://tasks.office.com/Home/Planner/#/plantaskboard?planId=" & ThisItem.id)
            Tooltip: ="Open plan"
            Width: =58
            X: =btnPlan.Width - Self.Width
            Y: =20
            ZIndex: =4

    viewMultipleButton As groupContainer:
        Height: =85
        Visible: =CountRows(Filter(galListPlans.AllItems, cbSelectPlan.Value)) > 0 && CountRows(Filter(galListPlans.AllItems, cbSelectPlan.Value)) <= varMaxSimultaneousSelectedPlans
        Width: =513
        X: =780
        Y: =672
        ZIndex: =2

        iconArrowRight As icon.ChevronRight:
            BorderColor: =RGBA(32, 54, 71, 1)
            Color: =Theme.Color.Dark
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(244, 244, 244, 1)
            Height: =50
            Icon: =Icon.ChevronRight
            Width: =50
            X: =435
            Y: =17
            ZIndex: =1

        lblViewMultiple As label:
            Align: =Align.Right
            BorderColor: =RGBA(32, 54, 71, 1)
            Color: =Theme.Color.Dark
            DisabledColor: =RGBA(166, 166, 166, 1)
            FontWeight: =FontWeight.Semibold
            Height: =84
            OnSelect: |-
                =Navigate(scrGantt, ScreenTransition.Fade, { idsOfSelectedPlans: ShowColumns(Filter(galListPlans.AllItems, cbSelectPlan.Value), "id", "title"), myTasks: false })
            PaddingRight: =80
            Size: =16
            Text: ="View multiple plans on the same chart"
            Width: =509
            ZIndex: =2

    lblWarning As label:
        Align: =Align.Center
        BorderColor: =RGBA(32, 54, 71, 1)
        Color: =RGBA(151, 0, 0, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        Height: =85
        Size: =13
        Text: ="Only " & varMaxSimultaneousSelectedPlans & " simultaneously selected plans supported!"
        Visible: =CountRows(Filter(galListPlans.AllItems, cbSelectPlan.Value)) > varMaxSimultaneousSelectedPlans
        Width: =443
        X: =460
        Y: =683
        ZIndex: =3

    btnHiddenToProcessPreselectedPlan As button:
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Fill: =RGBA(100, 118, 132, 1)
        FontWeight: =FontWeight.Semibold
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =ColorFade(RGBA(100, 118, 132, 1), -20%)
        OnSelect: |-
            =Navigate(scrGantt, ScreenTransition.Fade, { 
                idsOfSelectedPlans: ShowColumns(Filter(Planner.ListMyPlansV2().value, id = Param("plan")), "id", "title")
             })
        Size: =15
        Text: ="Button"
        Visible: =false
        X: =40
        Y: =717
        ZIndex: =4

    refresh As groupContainer:
        Height: =85
        Visible: =!viewMultipleButton.Visible
        Width: =492
        X: =802
        Y: =672
        ZIndex: =5

        iconRefresh As icon.Reload:
            BorderColor: =RGBA(32, 54, 71, 1)
            Color: =Theme.Color.Dark
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(244, 244, 244, 1)
            Height: =50
            Icon: =Icon.Reload
            OnSelect: =ClearCollect(collAllUserPlans, Planner.ListMyPlansV2().value);
            Width: =50
            X: =435
            Y: =17
            ZIndex: =1

        lblRefreshPlans As label:
            Align: =Align.Right
            BorderColor: =RGBA(32, 54, 71, 1)
            Color: =Theme.Color.Dark
            DisabledColor: =RGBA(166, 166, 166, 1)
            FontWeight: =FontWeight.Semibold
            Height: =77
            OnSelect: =ClearCollect(collAllUserPlans, Planner.ListMyPlansV2().value);
            PaddingRight: =80
            Size: =16
            Text: ="Refresh screen"
            Width: =314
            X: =171
            Y: =5
            ZIndex: =2

    lblTitleStartScreen As label:
        BorderColor: =RGBA(32, 54, 71, 1)
        Color: =White
        DisabledColor: =RGBA(166, 166, 166, 1)
        Fill: =Theme.Color.Dark
        FontWeight: =FontWeight.Semibold
        Height: =60
        PaddingLeft: =galListPlans.X + btnPlan.X
        Size: =28
        Text: ="Select the plan you want to view"
        Width: =1366
        ZIndex: =6

    myTasks As groupContainer:
        Height: =85
        Visible: =!viewMultipleButton.Visible
        Width: =600
        X: =108
        Y: =672
        ZIndex: =7

        btnMyTasks As button:
            BorderColor: =Theme.Color.LighterDark
            Color: =Theme.Color.LighterDark
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: =Theme.Color.Light
            FontWeight: =FontWeight.Semibold
            Height: =Parent.Height
            HoverColor: =RGBA(255, 255, 255, 1)
            OnSelect: |-
                =Navigate(scrGantt, ScreenTransition.Fade, { idsOfSelectedPlans: Blank(), myTasks: true })
            PaddingRight: =60
            Size: =22
            Text: ="View ALL MY TASKS over all plans"
            Width: =Parent.Width
            ZIndex: =1

        iconUser As icon.Reload:
            BorderColor: =RGBA(32, 54, 71, 1)
            Color: =Theme.Color.LighterDark
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(244, 244, 244, 1)
            Height: =50
            Icon: =Icon.Person
            OnSelect: =ClearCollect(collAllUserPlans, Planner.ListMyPlansV2().value);
            Width: =50
            X: =Parent.Width - Self.Width - 30
            Y: =17
            ZIndex: =2

    contRating As groupContainer.manualLayoutContainer:
        Height: =60
        Width: =532
        X: =834
        ZIndex: =8

        imgRating As image:
            BorderColor: =RGBA(32, 54, 71, 1)
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Height: =40
            Image: |-
                ="https://fn-gantt-chart-rating.azurewebsites.net/api/rating-img/" & varRatingGuid & "/" & varUserRating & "/rating.png?ts=" & Text(
                    Now(),
                    "ddmmyyyyHHmmss"
                )
            Width: =208
            X: =Parent.Width - Self.Width - 10
            ZIndex: =1

        galRate As gallery.galleryHorizontal:
            BorderColor: =RGBA(32, 54, 71, 1)
            Height: =imgRating.Height
            Items: =Sequence(5, 1, 1)
            OnSelect: |-
                =Set(varUserRating, ThisItem.Value);
                Set(varRatingGuid, GUID());
            ShowScrollbar: =false
            TemplatePadding: =0
            TemplateSize: =Self.Width / 5
            Width: =220
            X: =Parent.Width - Self.Width - 5
            ZIndex: =2

            btnRate As button:
                Color: =RGBA(255, 255, 255, 0)
                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                DisabledFill: =RGBA(244, 244, 244, 1)
                Fill: =RGBA(100, 118, 132, 0)
                FontWeight: =FontWeight.Semibold
                HoverColor: =RGBA(255, 255, 255, 1)
                HoverFill: =Theme.Color.TaskBackground
                OnSelect: =Select(Parent)
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =15
                Text: =""
                Tooltip: =ThisItem.Value & "/5"
                Width: =46.8
                ZIndex: =1

        lblRateMe As label:
            Align: =Align.Right
            BorderColor: =RGBA(32, 54, 71, 1)
            Color: =RGBA(255, 255, 255, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            Height: =20
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =10
            PaddingTop: =0
            Size: =12
            Text: =Upper(If (varUserRating > 0, "Thank you!", "Rate the app"))
            VerticalAlign: =VerticalAlign.Bottom
            Width: =160
            X: =Parent.Width - Self.Width
            Y: =imgRating.Height
            ZIndex: =3

    "'Latest Version Info_1' As 'Latest Version Info'":
        Height: =60
        VersionFetched: =If (!IsBlank(VersionNumber) && VersionNumber > 0, Set(varLastestVersionNumber, VersionNumber))
        Width: =368
        X: =752
        ZIndex: =9

    lblOldVersion As label:
        Align: =Align.Center
        BorderColor: =RGBA(32, 54, 71, 1)
        Color: =RGBA(255, 255, 255, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        Fill: =lblTitleStartScreen.Fill
        Height: ='Latest Version Info_1'.Height
        Size: =13
        Text: |-
            =If (varLastestVersionNumber > varVersionNumber,
                "There is a new version of the app available, check info page...",
                "v." & Text(varVersionNumber)
            )
        Width: ='Latest Version Info_1'.Width
        X: =750
        ZIndex: =10

    rectSideBar As rectangle:
        BorderColor: =RGBA(32, 54, 71, 1)
        Fill: =lblTitleStartScreen.Fill
        Height: =App.Height
        Width: =30
        ZIndex: =11

    contInfo As groupContainer.manualLayoutContainer:
        Height: =150
        Width: =150
        X: =-30
        Y: =-30
        ZIndex: =12

        circleInfoBg2 As circle:
            BorderColor: =RGBA(32, 54, 71, 1)
            Fill: =White
            Height: =imgInfo.Height + 5
            Width: =imgInfo.Width + 5
            X: =Parent.Width / 2 - Self.Width / 2
            Y: =Parent.Height / 2 - Self.Height / 2
            ZIndex: =1

        circleInfoBg1 As circle:
            BorderColor: =RGBA(32, 54, 71, 1)
            Fill: =lblTitleStartScreen.Fill
            Height: =imgInfo.Height
            Width: =imgInfo.Width
            X: =Parent.Width / 2 - Self.Width / 2
            Y: =Parent.Height / 2 - Self.Height / 2
            ZIndex: =2

        imgInfo As image:
            BorderColor: =RGBA(32, 54, 71, 1)
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Image: =info
            OnSelect: =Navigate(scrInfo, Fade)
            X: =Parent.Width / 2 - Self.Width / 2
            Y: =Parent.Height / 2 - Self.Height / 2
            ZIndex: =3

        btnInfo As button:
            BorderStyle: =BorderStyle.None
            BorderThickness: =0
            Color: =RGBA(255, 255, 255, 0)
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: =RGBA(100, 118, 132, 0)
            FontWeight: =FontWeight.Semibold
            Height: =Parent.Height
            HoverColor: =RGBA(255, 255, 255, 0)
            HoverFill: =Self.Fill
            OnSelect: =Navigate(scrInfo, Fade)
            PressedFill: =Self.Fill
            Size: =15
            Text: =""
            Width: =Parent.Width
            ZIndex: =4

